# ğŸ“» Advanced Walkie-Talkie Firmware

## ××›×©×™×¨ ×§×©×¨ ××ª×§×“× - WT-PRO

![Version](https://img.shields.io/badge/version-1.0.0-blue)
![Platform](https://img.shields.io/badge/platform-ESP32-green)
![Framework](https://img.shields.io/badge/framework-ESP--IDF-orange)
![License](https://img.shields.io/badge/license-MIT-lightgrey)

---

## ğŸ“‹ ×ª×•×›×Ÿ ×¢× ×™×™× ×™×

- [××˜×¨×ª ×”×¤×¨×•×™×§×˜](#-××˜×¨×ª-×”×¤×¨×•×™×§×˜)
- [×ª×›×•× ×•×ª](#-×ª×›×•× ×•×ª)
- [×“×¨×™×©×•×ª ×—×•××¨×”](#-×“×¨×™×©×•×ª-×—×•××¨×”)
- [×—×™×‘×•×¨×™ ×¤×™× ×™×](#-×—×™×‘×•×¨×™-×¤×™× ×™×)
- [×”×ª×§× ×”](#-×”×ª×§× ×”)
- [×‘× ×™×™×” ×•×¦×¨×™×‘×”](#-×‘× ×™×™×”-×•×¦×¨×™×‘×”)
- [×©×™××•×©](#-×©×™××•×©)
- [××¨×›×™×˜×§×˜×•×¨×”](#-××¨×›×™×˜×§×˜×•×¨×”)
- [×ª×¨×•××” ×œ×¤×¨×•×™×§×˜](#-×ª×¨×•××”-×œ×¤×¨×•×™×§×˜)

---

## ğŸ¯ ××˜×¨×ª ×”×¤×¨×•×™×§×˜

×¤×™×ª×•×— ××›×©×™×¨ ×§×©×¨ ×“×™×’×™×˜×œ×™ ××ª×§×“× ×”××‘×•×¡×¡ ×¢×œ ×˜×›× ×•×œ×•×’×™×™×ª **LoRa** ×œ×ª×§×©×•×¨×ª ××¨×•×›×ª ×˜×•×•×— (×¢×“ 10+ ×§"× ×‘×§×• ×¨××™×™×”).

### ×™×¢×“×™× ×¢×™×§×¨×™×™×:
- **×ª×§×©×•×¨×ª ×××•×‘×˜×—×ª** - ×”×¦×¤× ×ª AES-128-GCM ×¢× ×”×—×œ×¤×ª ××¤×ª×—×•×ª ECDH
- **×©×™×—×•×ª ×¤×¨×˜×™×•×ª** - 1-×¢×œ-1 ×‘×™×Ÿ ×©× ×™ ××›×©×™×¨×™×
- **×¢×¨×•×¦×™ ×ª×“×¨ ×§×‘×•×¦×ª×™×™×** - ×ª××™×›×” ×‘×¢×“ 100 ××©×ª×ª×¤×™×
- **×”×§×œ×˜×ª ×©×™×—×•×ª** - ×©××™×¨×” ×œ×›×¨×˜×™×¡ SD ××• ×–×™×›×¨×•×Ÿ ×¤× ×™××™
- **×××©×§ ××©×ª××© ××™× ×˜×•××™×˜×™×‘×™** - ××¡×š OLED + ××§×œ×“×ª + ×’×œ×’×œ×•×ª

---

## âœ¨ ×ª×›×•× ×•×ª

| ×ª×›×•× ×” | ×ª×™××•×¨ |
|-------|-------|
| ğŸ“¡ **LoRa RF** | ×˜×•×•×— ××¨×•×š, ×¦×¨×™×›×ª ×× ×¨×’×™×” × ××•×›×” |
| ğŸ” **×”×¦×¤× ×”** | AES-128-GCM + ECDH key exchange |
| ğŸ‘¥ **×ª×“×¨×™×** | ×¢×¨×•×¦×™× ×§×‘×•×¦×ª×™×™× ×¢× ×”×¨×©××•×ª |
| ğŸ™ï¸ **PTT** | Push-To-Talk ×¢× 3 ××¦×‘×™× |
| ğŸ“¼ **×”×§×œ×˜×”** | ×©××™×¨×” ×œ-SD/SPIFFS |
| ğŸ”‹ **×¡×•×œ×œ×”** | × ×™×”×•×œ ×¦×¨×™×›×” ×—×›× |
| ğŸ“º **××¡×š** | OLED 128x64 SSD1306 |
| ğŸ”„ **OTA** | ×¢×“×›×•× ×™ firmware ××œ×—×•×˜×™×™× |

---

## ğŸ”§ ×“×¨×™×©×•×ª ×—×•××¨×”

### ×¨×›×™×‘×™× × ×“×¨×©×™×

| ×¨×›×™×‘ | ××•×“×œ ××•××œ×¥ | ×›××•×ª | ×”×¢×¨×•×ª |
|------|------------|------|-------|
| **××™×§×¨×•-×‘×§×¨** | ESP32-DevKitC / ESP32-S3 | 1 | ESP32-S3 ×¢×“×™×£ ×œ-USB Mass Storage |
| **××•×“×•×œ LoRa** | SX1276 / RFM95W | 1 | 433MHz / 868MHz / 915MHz |
| **××¡×š** | SSD1306 OLED 128x64 | 1 | I2C ××• SPI |
| **××™×§×¨×•×¤×•×Ÿ** | MAX9814 AGC | 1 | ×¢× AGC ××•×˜×•××˜×™ |
| **×¨××§×•×œ** | 8Î© 0.5W | 1 | ×¢× ××’×‘×¨ PAM8403 |
| **×›×¨×˜×™×¡ SD** | ××•×“×•×œ MicroSD SPI | 1 | ××•×¤×¦×™×•× ×œ×™ |
| **×¡×•×œ×œ×”** | LiPo 3.7V 2000mAh | 1 | ×¢× ××•×“×•×œ TP4056 |
| **××§×œ×“×ª** | 4x3 Matrix | 1 | 0-9 + * + # |
| **×›×¤×ª×•×¨×™×** | Push Button | 6 | ×™×¨×•×§, ××“×•×, PTT ×•×›×•' |
| **××ª×’×™ ×”×–×–×”** | Slide Switch | 2 | PTT 3-××¦×‘×™×, × ×¨××•×ª |
| **×’×œ×’×œ×•×ª** | Rotary Encoder | 2 | ×•×•×œ×™×•× + ×‘×•×¨×¨ ××¦×‘ |

### ××•×“×•×œ×™ LoRa × ×ª××›×™×

| ××•×“×•×œ | ×ª×“×¨ | ×˜×•×•×— | ×”×¢×¨×•×ª |
|-------|-----|------|-------|
| **RFM95W** | 868/915 MHz | ~10 km | ××•××œ×¥ |
| **SX1276** | 433/868/915 MHz | ~15 km | ×˜×•×•×— ××§×¡×™××œ×™ |
| **SX1278** | 433 MHz | ~12 km | ×™×¤×Ÿ, ××¡×™×” |
| **Ra-02** | 433 MHz | ~10 km | ×—×œ×•×¤×” ×–×•×œ×” |

> âš ï¸ **×©×™××• ×œ×‘**: ×‘×—×¨×• ×ª×“×¨ ××•×ª×¨ ×‘××–×•×¨×›× (433MHz ×œ×¨×•×‘ ××¡×™×”, 868MHz ××™×¨×•×¤×”, 915MHz ××¨×”"×‘)

---

## ğŸ“Œ ×—×™×‘×•×¨×™ ×¤×™× ×™×

### ESP32 DevKit Pinout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ESP32 DevKit               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  [LoRa Module - SX1276/RFM95]           â”‚
â”‚    CS   â†’ GPIO 5                        â”‚
â”‚    RST  â†’ GPIO 14                       â”‚
â”‚    DIO0 â†’ GPIO 2                        â”‚
â”‚    MOSI â†’ GPIO 23                       â”‚
â”‚    MISO â†’ GPIO 19                       â”‚
â”‚    SCK  â†’ GPIO 18                       â”‚
â”‚                                         â”‚
â”‚  [OLED Display - SSD1306 SPI]           â”‚
â”‚    CS   â†’ GPIO 2                        â”‚
â”‚    DC   â†’ GPIO 16                       â”‚
â”‚    RST  â†’ GPIO 17                       â”‚
â”‚    SCK  â†’ GPIO 18 (shared)              â”‚
â”‚    MOSI â†’ GPIO 23 (shared)              â”‚
â”‚                                         â”‚
â”‚  [Keypad Matrix 4x3]                    â”‚
â”‚    ROW0 â†’ GPIO 4                        â”‚
â”‚    ROW1 â†’ GPIO 5                        â”‚
â”‚    ROW2 â†’ GPIO 18                       â”‚
â”‚    ROW3 â†’ GPIO 19                       â”‚
â”‚    COL0 â†’ GPIO 21                       â”‚
â”‚    COL1 â†’ GPIO 22                       â”‚
â”‚    COL2 â†’ GPIO 23                       â”‚
â”‚                                         â”‚
â”‚  [Function Buttons]                     â”‚
â”‚    GREEN      â†’ GPIO 25                 â”‚
â”‚    RED        â†’ GPIO 26                 â”‚
â”‚    ABOVE_GRN  â†’ GPIO 27                 â”‚
â”‚    ABOVE_RED  â†’ GPIO 32                 â”‚
â”‚    MULTI      â†’ GPIO 33                 â”‚
â”‚    RECORD     â†’ GPIO 34                 â”‚
â”‚                                         â”‚
â”‚  [PTT Button + Slide Switch]            â”‚
â”‚    PTT_BTN    â†’ GPIO 35                 â”‚
â”‚    SLIDE_A    â†’ GPIO 36                 â”‚
â”‚    SLIDE_B    â†’ GPIO 39                 â”‚
â”‚                                         â”‚
â”‚  [Visibility Switch]                    â”‚
â”‚    VIS_SW     â†’ GPIO 13                 â”‚
â”‚                                         â”‚
â”‚  [Rotary Encoders]                      â”‚
â”‚    VOL_A      â†’ GPIO 14                 â”‚
â”‚    VOL_B      â†’ GPIO 12                 â”‚
â”‚    MODE_DIAL  â†’ GPIO 15 (ADC)           â”‚
â”‚                                         â”‚
â”‚  [Audio]                                â”‚
â”‚    AUDIO_OUT  â†’ GPIO 25 (DAC1)          â”‚
â”‚    AUDIO_IN   â†’ GPIO 36 (ADC)           â”‚
â”‚    SPEAKER_EN â†’ GPIO 0                  â”‚
â”‚                                         â”‚
â”‚  [SD Card]                              â”‚
â”‚    CS         â†’ GPIO 4                  â”‚
â”‚    MOSI       â†’ GPIO 23                 â”‚
â”‚    MISO       â†’ GPIO 19                 â”‚
â”‚    SCK        â†’ GPIO 18                 â”‚
â”‚                                         â”‚
â”‚  [USB & Battery]                        â”‚
â”‚    USB_DET    â†’ GPIO 37                 â”‚
â”‚    BATT_ADC   â†’ GPIO 38                 â”‚
â”‚    CHRG_STAT  â†’ GPIO 1                  â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

> ğŸ“„ ×œ×ª×™×¢×•×“ ××¤×•×¨×˜ ×™×•×ª×¨ ×¨××• [WIRING.md](./WIRING.md)

---

## ğŸ’¾ ×”×ª×§× ×”

### ×“×¨×™×©×•×ª ×ª×•×›× ×”

1. **PlatformIO** (××•××œ×¥)
   ```bash
   pip install platformio
   ```

2. **××• VS Code + PlatformIO Extension**
   - ×”×ª×§×™× ×• [VS Code](https://code.visualstudio.com/)
   - ×—×¤×©×• ×•×”×ª×§×™× ×• "PlatformIO IDE" ×‘×ª×•×¡×¤×™×

3. **Python 3.x** (×œ×¡×§×¨×™×¤×˜×™×)

### ×©×›×¤×•×œ ×”×¤×¨×•×™×§×˜

```bash
git clone https://github.com/your-username/walkie-talkie-firmware.git
cd walkie-talkie-firmware
```

### ×”×ª×§× ×ª ×ª×œ×•×™×•×ª

```bash
pio pkg install
```

---

## ğŸ”¨ ×‘× ×™×™×” ×•×¦×¨×™×‘×”

### ×‘× ×™×™×” ×‘×¡×™×¡×™×ª

```bash
# ×‘× ×™×™×ª ×”×’×¨×¡×” ×”×¨×’×™×œ×” (ESP-IDF)
pio run

# ×‘× ×™×™×ª ×’×¨×¡×ª Arduino
pio run -e esp32-arduino

# ×‘× ×™×™×ª ×’×¨×¡×ª Release (××•×¤×˜×™××™×–×¦×™×”)
pio run -e esp32-release

# ×‘× ×™×™×ª ×’×¨×¡×ª Debug
pio run -e esp32-debug
```

### ×¦×¨×™×‘×” ×œ××™×§×¨×•-×‘×§×¨

```bash
# ×¦×¨×™×‘×” ××•×˜×•××˜×™×ª (×–×™×”×•×™ ×¤×•×¨×˜)
pio run -e esp32-release -t upload

# ×¦×¨×™×‘×” ×œ×¤×•×¨×˜ ×¡×¤×¦×™×¤×™
pio run -e esp32-release -t upload --upload-port COM3      # Windows
pio run -e esp32-release -t upload --upload-port /dev/ttyUSB0  # Linux

# ×¦×¨×™×‘×” ×¢× esptool ×™×©×™×¨×•×ª
esptool.py --chip esp32 --port COM3 --baud 921600 \
    write_flash -z 0x1000 .pio/build/esp32-release/firmware.bin
```

### ×¦×¨×™×‘×” OTA (×¢×“×›×•×Ÿ ××œ×—×•×˜×™)

```bash
# ×”×’×“×¨×ª ×›×ª×•×‘×ª ×”××›×©×™×¨
pio run -e esp32-ota -t upload --upload-port 192.168.1.100
```

### × ×™×˜×•×¨ Serial

```bash
pio device monitor

# ×¢× ××¤×¢× ×— exceptions
pio device monitor --filter esp32_exception_decoder
```

---

## ğŸ“¦ Dependencies (×¡×¤×¨×™×•×ª)

| ×¡×¤×¨×™×™×” | ×’×¨×¡×” | ×©×™××•×© |
|--------|------|-------|
| `sandeepmistry/LoRa` | ^0.8.0 | ×ª×§×©×•×¨×ª RF |
| `adafruit/Adafruit SSD1306` | ^2.5.7 | ×“×¨×™×™×‘×¨ ××¡×š |
| `adafruit/Adafruit GFX Library` | ^1.11.5 | ×’×¨×¤×™×§×” |
| `arduino-libraries/SD` | ^1.2.4 | ×›×¨×˜×™×¡ SD |
| `throwtheswitch/Unity` | ^2.5.2 | ×‘×“×™×§×•×ª ×™×—×™×“×” |

---

## ğŸ“ ××‘× ×” ×”×¤×¨×•×™×§×˜

```
firmware/
â”œâ”€â”€ include/
â”‚   â”œâ”€â”€ config.h              # ×”×’×“×¨×•×ª ×›×œ×œ×™×•×ª
â”‚   â”œâ”€â”€ hal/                   # Hardware Abstraction Layer
â”‚   â”‚   â”œâ”€â”€ audio.h           # ×××©×§ ××•×“×™×•
â”‚   â”‚   â”œâ”€â”€ buttons.h         # ×›×¤×ª×•×¨×™× ×•××ª×’×™×
â”‚   â”‚   â””â”€â”€ display.h         # ××¡×š OLED
â”‚   â”œâ”€â”€ core/                  # ×œ×™×‘×ª ×”××¢×¨×›×ª
â”‚   â”‚   â”œâ”€â”€ device_state.h    # ××›×•× ×ª ××¦×‘×™×
â”‚   â”‚   â”œâ”€â”€ dial_manager.h    # × ×™×”×•×œ ×—×™×‘×•×¨×™×
â”‚   â”‚   â”œâ”€â”€ audio_buffer.h    # ×‘××¤×¨×™× ×œ××•×“×™×•
â”‚   â”‚   â””â”€â”€ tasks.h           # ××©×™××•×ª FreeRTOS
â”‚   â””â”€â”€ comm/                  # ×ª×§×©×•×¨×ª
â”‚       â”œâ”€â”€ radio.h           # ×“×¨×™×™×‘×¨ LoRa
â”‚       â”œâ”€â”€ protocol.h        # ×¤×¨×•×˜×•×§×•×œ ×ª×§×©×•×¨×ª
â”‚       â”œâ”€â”€ protocol_v2.h     # ×¤×¨×•×˜×•×§×•×œ ×’×¨×¡×” 2
â”‚       â””â”€â”€ security.h        # ×”×¦×¤× ×” ×•××‘×˜×—×”
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.c                # × ×§×•×“×ª ×›× ×™×¡×”
â”‚   â”œâ”€â”€ hal/                   # ××™××•×© HAL
â”‚   â”œâ”€â”€ core/                  # ××™××•×© ×œ×™×‘×”
â”‚   â””â”€â”€ comm/                  # ××™××•×© ×ª×§×©×•×¨×ª
â”œâ”€â”€ lib/                       # ×¡×¤×¨×™×•×ª ××§×•××™×•×ª
â”œâ”€â”€ data/                      # ×§×‘×¦×™ × ×ª×•× ×™× (SPIFFS)
â”œâ”€â”€ scripts/                   # ×¡×§×¨×™×¤×˜×™ ×‘× ×™×™×”
â”œâ”€â”€ docs/                      # ×ª×™×¢×•×“
â”‚   â””â”€â”€ datasheets/           # ×“×¤×™ × ×ª×•× ×™×
â”œâ”€â”€ platformio.ini            # ×”×’×“×¨×•×ª PlatformIO
â”œâ”€â”€ WIRING.md                 # ×ª×™×¢×•×“ ×—×™×‘×•×¨×™×
â””â”€â”€ README.md                 # ×§×•×‘×¥ ×–×”
```

---

## ğŸ® ×©×™××•×©

### ××¦×‘×™ PTT (Push-To-Talk)

| ××¦×‘ ××ª×’ | ×”×ª× ×”×’×•×ª |
|---------|----------|
| ğŸ”¼ ×œ××¢×œ×” | **×ª××™×“ ××©×“×¨** - ××™×§×¨×•×¤×•×Ÿ ×¤×ª×•×— ×›×œ ×”×–××Ÿ |
| âºï¸ ×××¦×¢ | **PTT ×¨×’×™×œ** - ×œ×—×™×¦×” ×œ×©×™×“×•×¨ |
| ğŸ”½ ×œ××˜×” | **××•×©×ª×§** - ×œ× ××©×“×¨ ×›×œ×œ |

### ×—×™×•×’ ×œ×§×•×“

1. ×”×–×™× ×• 8 ×¡×¤×¨×•×ª (×§×•×“ ××›×©×™×¨ ××• ×ª×“×¨)
2. ×œ×—×¦×• **×™×¨×•×§** ×œ×”×ª×§×©×¨×•×ª
3. ×”××ª×™× ×• ×œ×ª×©×•×‘×”

### ×™×¦×™×¨×ª ×ª×“×¨ ×—×“×©

1. ×¡×•×‘×‘×• ××ª ×’×œ×’×œ×ª ×”××¦×‘×™× ×œ×¢××“×” 1-15
2. ×œ×—×¦×• **×™×¨×•×§** ×œ×™×¦×™×¨×ª ×ª×“×¨
3. ×‘×—×¨×• ×¡×•×’ (×’×œ×•×™/× ×¡×ª×¨)
4. ×‘×—×¨×• ×”×’× ×” (×œ×œ×/×¡×™×¡××”/××™×©×•×¨)

### ×”×§×œ×˜×”

- ×œ×—×¦×• ×¢×œ ×›×¤×ª×•×¨ **×”×§×œ×˜×”** ×œ×”×ª×—×œ×”/×¢×¦×™×¨×”
- ×”×”×§×œ×˜×•×ª × ×©××¨×•×ª ×œ-SD ××• SPIFFS
- ×’×™×©×” ×“×¨×š USB Mass Storage (ESP32-S3)

---

## ğŸ—ï¸ ××¨×›×™×˜×§×˜×•×¨×”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Application                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ Device Stateâ”‚  â”‚Dial Manager â”‚  â”‚   Screens   â”‚      â”‚
â”‚  â”‚   Machine   â”‚  â”‚  (15 slots) â”‚  â”‚   (UI/UX)   â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         â”‚       Core Layer                 â”‚            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚Audio Buffer â”‚  â”‚  Protocol   â”‚  â”‚  Security   â”‚     â”‚
â”‚  â”‚  + Jitter   â”‚  â”‚   V1/V2     â”‚  â”‚  AES+ECDH   â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         â”‚       HAL Layer                  â”‚            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚   Audio     â”‚  â”‚   Radio     â”‚  â”‚  Display    â”‚     â”‚
â”‚  â”‚  I2S/DAC    â”‚  â”‚ SX1276/LoRa â”‚  â”‚  SSD1306    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         â”‚       Hardware                   â”‚            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Microphone  â”‚  â”‚  RF Module  â”‚  â”‚ OLED Screen â”‚     â”‚
â”‚  â”‚  + Speaker  â”‚  â”‚  + Antenna  â”‚  â”‚   128x64    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¡ ×¤×¨×•×˜×•×§×•×œ ×ª×§×©×•×¨×ª

### ××‘× ×” ×—×‘×™×œ×”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Header â”‚ Src ID â”‚ Dst ID â”‚  Type  â”‚    Payload     â”‚  CRC   â”‚
â”‚ 2 byte â”‚ 8 byte â”‚ 8 byte â”‚ 1 byte â”‚  0-220 bytes   â”‚ 2 byte â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ×¡×•×’×™ ×”×•×“×¢×•×ª

| ×§×•×“ | ×¡×•×’ | ×ª×™××•×¨ |
|-----|-----|-------|
| 0x01 | DISCOVER | ×¡×¨×™×§×ª ××›×©×™×¨×™× |
| 0x02 | DISCOVER_RESP | ×ª×©×•×‘×” ×œ×¡×¨×™×§×” |
| 0x10 | CALL_REQUEST | ×‘×§×©×ª ×©×™×—×” |
| 0x11 | CALL_ACCEPT | ××™×©×•×¨ ×©×™×—×” |
| 0x12 | CALL_REJECT | ×“×—×™×™×ª ×©×™×—×” |
| 0x1F | CALL_END | ×¡×™×•× ×©×™×—×” |
| 0x20 | FREQ_CREATE | ×™×¦×™×¨×ª ×ª×“×¨ |
| 0x30 | VOICE_DATA | × ×ª×•× ×™ ××•×“×™×• |

---

## ğŸ” ××‘×˜×—×”

### ×–×™×”×•×™ ××›×©×™×¨ (Unique ID)

×”××›×©×™×¨ ××©×ª××© ×‘××–×”×” ×™×™×—×•×“×™ ×”××‘×•×¡×¡ ×¢×œ:
- **ESP32**: MAC address ×©×œ WiFi/BT
- **ESP32-S3**: eFuse UID

×”×§×•×“ ××—×•×œ×œ ××–×”×” 8 ×¡×¤×¨×•×ª ×™×™×—×•×“×™ ×©× ×©××¨ ×‘-NVS.

### ×”×¦×¤× ×”

1. **ECDH Key Exchange** (X25519) - ×”×—×œ×¤×ª ××¤×ª×—×•×ª
2. **AES-128-GCM** - ×”×¦×¤× ×ª × ×ª×•× ×™ ×§×•×œ
3. **Nonce Counter** - ×”×’× ×” ××¤× ×™ replay attacks

---

## ğŸ§ª ×‘×“×™×§×•×ª

```bash
# ×”×¨×¦×ª ×‘×“×™×§×•×ª ×™×—×™×“×”
pio test -e native

# ×‘×“×™×§×•×ª ×¢×œ ×”×—×•××¨×”
pio test -e esp32-debug
```

---

## ğŸ“¤ ×™×¦×™×¨×ª Release

```bash
# ×‘× ×™×™×” ×œ×™×¦×™×¨×ª binary
pio run -e esp32-release

# ×”×§×•×‘×¥ ×™×™××¦× ×‘:
# .pio/build/esp32-release/firmware.bin

# ×™×¦×™×¨×ª release ××œ× (×¢× bootloader ×•-partitions)
./scripts/create_release.sh 1.0.0
```

### ×§×‘×¦×™ Release

| ×§×•×‘×¥ | ×ª×™××•×¨ |
|------|-------|
| `firmware_v1.0.0.bin` | Firmware ×‘×œ×‘×“ |
| `firmware_v1.0.0_full.bin` | ×›×•×œ×œ bootloader |
| `firmware_v1.0.0_ota.bin` | ×œ×¢×“×›×•×Ÿ OTA |

---

## ğŸ”§ ×¤×ª×¨×•×Ÿ ×‘×¢×™×•×ª

### ×”×¨×“×™×• ×œ× ××–×•×”×”

```
[RADIO ERROR] Invalid radio version (expected 0x12)
```

**×¤×ª×¨×•×Ÿ**: ×‘×“×§×• ×—×™×‘×•×¨×™ SPI (MOSI, MISO, SCK, CS)

### ×©×’×™××•×ª ×”×¦×¤× ×”

```
[SECURITY] Authentication failed
```

**×¤×ª×¨×•×Ÿ**: ×•×•×“××• ×©× ×™ ×”×¦×“×“×™× ××©×ª××©×™× ×‘××•×ª×• ××¤×ª×—/×¡×™×¡××”

### ×‘×¢×™×•×ª ××•×“×™×•

**×¤×ª×¨×•×Ÿ**: ×‘×“×§×• ×—×™×‘×•×¨×™ DAC/ADC ×•×”×’×‘×™×¨×• ×‘-`config.h`

---

## ğŸ¤ ×ª×¨×•××” ×œ×¤×¨×•×™×§×˜

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/amazing-feature`)
3. Commit changes (`git commit -m 'Add amazing feature'`)
4. Push to branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

---

## ğŸ“œ ×¨×™×©×™×•×Ÿ

MIT License - ×¨××• [LICENSE](./LICENSE) ×œ×¤×¨×˜×™×.

---

## ğŸ“ ×™×¦×™×¨×ª ×§×©×¨

- ğŸ“§ Email: your-email@example.com
- ğŸ› Issues: [GitHub Issues](https://github.com/your-username/walkie-talkie-firmware/issues)

---

<div align="center">

**Made with â¤ï¸ for the maker community**

ğŸ”Š *Happy Talking!* ğŸ“»

</div>

